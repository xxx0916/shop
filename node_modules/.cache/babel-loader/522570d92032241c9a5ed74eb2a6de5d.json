{"ast":null,"code":"import { mapState } from 'vuex'; // 这种引入是把lodash的全部功能函数引入了\n// 按需引入\n\nimport throttle from 'lodash/throttle';\nexport default {\n  name: 'TypeNav',\n\n  data() {\n    return {\n      // 存储用户鼠标移上哪一个一级分类\n      currentIndex: -1,\n      show: true\n    };\n  },\n\n  // 组件挂载完毕：可以向服务器发送请求\n  mounted() {\n    // 当组件挂载完毕，让show属性变成false\n    // 如果不是home组件，将typeNav进行隐藏\n    if (this.$route.path != '/home') {\n      this.show = false;\n    }\n  },\n\n  computed: { ...mapState({\n      categoryList: state => {\n        return state.home.categoryList;\n      }\n    })\n  },\n  methods: {\n    // 鼠标进入修改响应式数据currentIndex属性\n    // changeIndex(index) {\n    // index:鼠标移上某一个一级分类的元素的索引值\n    // 正常情况（用户慢慢的操作）：鼠标进入，每一个一级分类h3，都会触发鼠标进入事件\n    // 非正常情况（用户操作很快）：本身全部的一级分类应该触发鼠标进入事件，但是经过测试，只有一部分h3触发了\n    // 就是由于用户行为过快，导致浏览器反应不过来，如果当前回调函数中有一些大量的业务，有可能出现卡顿现象\n    // this.currentIndex = index\n    // },\n    // throttle别用箭头函数，会出现this指向的问题\n    changeIndex: throttle(function (index) {\n      this.currentIndex = index;\n    }, 50),\n\n    goSearch(event) {\n      // 最好的解决方案：编程式导航+事件委派\n      //第一个问题:div父节点子元素太多【h3、h2、em、dt、dd、dl...a】？你怎么知道你点击的一定是a\n      //第二个问题:要区分一级分类、二级分类、三级分类的a标签 【category1Id|category2Id|category2Id】\n      // 第一个问题：把子节点当中a标签，我加上自定义属性data-categoryName,其余子节点是没有的\n      let element = event.target; //获取到当前出发这个事件的节点【h3,a,dt,dl】,需要带有data-categoryName这样的节点【一定是a标签】\n      // 节点有一个属性dataset属性，可以获取节点的自定义属性与属性值\n\n      let {\n        categoryname,\n        category1id,\n        category2id,\n        category3id\n      } = element.dataset; // 如果标签身上拥有categoryname一定是a标签\n\n      if (categoryname) {\n        // 整理路由跳转的参数\n        let location = {\n          name: 'search'\n        };\n        let query = {\n          categoryName: categoryname\n        }; // 一级，二级，三级分类的a标签\n\n        if (category1id) {\n          query.category1Id = category1id;\n        } else if (category2id) {\n          query.category2Id = category2id;\n        } else {\n          query.category3Id = category3id;\n        } //    判断：如果路由跳转的时候，带有params参数，捎带传递过去\n\n\n        if (this.$route.params) {\n          location.params = this.$route.params; // 整理参数\n\n          location.query = query; // 路由跳转\n\n          this.$router.push(location);\n        }\n      }\n    },\n\n    // 一级分类鼠标移出的事件回调\n    // 当鼠标移出的时候，让商品分类列表进行隐藏\n    leaveIndex() {\n      this.currentIndex = -1;\n\n      if (this.$route.path != '/home') {\n        this.show = false;\n      }\n    },\n\n    // 在search组件中，当鼠标移入的时候，让商品分类列表进行展示\n    enterShow() {\n      if (this.$route.path != '/home') {\n        this.show = true;\n      }\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}