{"ast":null,"code":"import { mapState } from 'vuex';\nexport default {\n  name: 'Trade',\n\n  data() {\n    return {\n      // 收集买家留言信息\n      msg: '',\n      // 订单号\n      orderId: ''\n    };\n  },\n\n  mounted() {\n    this.$store.dispatch('getUserAddress');\n    this.$store.dispatch('getOrderInfo');\n  },\n\n  computed: { ...mapState({\n      addressInfo: state => state.trade.address,\n      orderInfo: state => state.trade.orderInfo\n    }),\n\n    // 将来提交订单最终选中地址\n    userDefaultAddress() {\n      // find：查找数组中符合条件的元素返回\n      return this.addressInfo.find(item => item.isDefault == 1) || {};\n    }\n\n  },\n  methods: {\n    // 修改默认地址\n    changeDefault(address, addressInfo) {\n      // 全部的isDefault为零\n      addressInfo.forEach(item => item.isDefault = 0);\n      address.isDefault = 1;\n    },\n\n    // 提交订单\n    async submitOrder() {\n      // console.log(this.$API);\n      // 交易编码\n      let {\n        tradeNo\n      } = this.orderInfo; // 其他六个参数\n\n      let data = {\n        consignee: this.userDefaultAddress.consignee,\n        //收件人的名字\n        consigneeTel: this.userDefaultAddress.phoneNum,\n        //手机号\n        deliveryAddress: this.userDefaultAddress.fullAddress,\n        //地址\n        paymentWay: \"ONLINE\",\n        //支付方式\n        orderComment: this.msg,\n        //买家留言信息\n        orderDetailList: this.orderInfo.detailArrayList //商品清单\n\n      }; // 需要带的参数：tradeNo\n\n      let result = await this.$API.reqSubmitOrder(tradeNo, data); // 提交订单成功\n\n      if (result.code == 200) {\n        this.orderId = result.data; // 路由跳转+路由传参数\n\n        this.$router.push('/pay?orderId=' + this.orderId); // 提交订单失败\n      } else {\n        alert(result.data);\n      }\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}