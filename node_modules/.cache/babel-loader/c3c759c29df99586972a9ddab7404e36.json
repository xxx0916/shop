{"ast":null,"code":"import { mapState } from 'vuex'; // 这种引入是把lodash的全部功能函数引入了\n// 按需引入\n\nimport throttle from 'lodash/throttle';\nexport default {\n  name: 'TypeNav',\n\n  data() {\n    return {\n      // 存储用户鼠标移上哪一个一级分类\n      currentIndex: -1\n    };\n  },\n\n  // 组件挂载完毕：可以向服务器发送请求\n  mounted() {\n    // 通知Vuex发送请求，获取数据，用于存储仓库当中\n    this.$store.dispatch('categoryList');\n  },\n\n  computed: { ...mapState({\n      categoryList: state => {\n        return state.home.categoryList;\n      }\n    })\n  },\n  methods: {\n    // 鼠标进入修改响应式数据currentIndex属性\n    // changeIndex(index) {\n    // index:鼠标移上某一个一级分类的元素的索引值\n    // 正常情况（用户慢慢的操作）：鼠标进入，每一个一级分类h3，都会触发鼠标进入事件\n    // 非正常情况（用户操作很快）：本身全部的一级分类应该触发鼠标进入事件，但是经过测试，只有一部分h3触发了\n    // 就是由于用户行为过快，导致浏览器反应不过来，如果当前回调函数中有一些大量的业务，有可能出现卡顿现象\n    // this.currentIndex = index\n    // },\n    // throttle别用箭头函数，会出现this指向的问题\n    changeIndex: throttle(function (index) {\n      this.currentIndex = index;\n    }, 50),\n\n    // 一级分类鼠标移出的事件回调\n    leaveIndex() {\n      this.currentIndex = -1;\n    },\n\n    goSearch() {\n      // 最好的解决方案：编程式导航+事件委派\n      //第一个问题:div父节点子元素太多【h3、h2、em、dt、dd、dl...a】？你怎么知道你点击的一定是a\n      //第二个问题:要区分一级分类、二级分类、三级分类的a标签 【category1Id|category2Id|category2Id】\n      // 第一个问题：把子节点当中a标签，我加上自定义属性data-categoryName,其余子节点是没有的\n      let element = event.target; //获取到当前出发这个事件的节点【h3,a,dt,dl】,需要带有data-categoryName这样的节点【一定是a标签】\n      // 节点有一个属性dataset属性，可以获取节点的自定义属性与属性值\n\n      let {\n        categoryname,\n        category1id,\n        category2id,\n        category3id\n      } = targetNode.dataset; // 如果标签身上拥有categoryname一定是a标签\n\n      if (categoryname) {\n        // 整理路由跳转的参数\n        let location = {\n          name: 'search'\n        };\n        let query = {\n          categoryName: categoryname\n        }; // 一级，二级，三级分类的a标签\n\n        if (category1id) {\n          query.category1Id = category1id;\n        } else if (category2id) {\n          query.category2Id = category2id;\n        } else {\n          query.category3Id = category3id;\n        } // 整理参数\n\n\n        location.query = query; // 路由跳转\n\n        this.$router.push(location);\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA2DA,gC,CACA;AACA;;AACA;AACA;EACAA,eADA;;EAEAC;IACA;MACA;MACAC;IAFA;EAIA,CAPA;;EAQA;EACAC;IACA;IACA;EACA,CAZA;;EAaAC,YACA;MACAC;QACA;MACA;IAHA;EADA,CAbA;EAoBAC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MACA;IACA,CAFA,EAEA,EAFA,CAVA;;IAaA;IACAC;MACA;IACA,CAhBA;;IAiBAC;MACA;MACA;MACA;MAEA;MACA,2BANA,CAOA;MACA;;MACA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA,IACAC,kBADA,CATA,CAWA;;MACA;QACA;QACA;UAAAd;QAAA;QACA;UAAAe;QAAA,EAHA,CAIA;;QACA;UACAC;QACA,CAFA,MAEA;UACAA;QACA,CAFA,MAEA;UACAA;QACA,CAXA,CAYA;;;QACAC,uBAbA,CAcA;;QACA;MACA;IACA;;EA9CA;AApBA","names":["name","data","currentIndex","mounted","computed","categoryList","methods","changeIndex","leaveIndex","goSearch","categoryname","category1id","category2id","category3id","targetNode","categoryName","query","location"],"sourceRoot":"src/components/TypeNav","sources":["index.vue"],"sourcesContent":["<template>\r\n    <!-- 商品分类导航 -->\r\n    <div class=\"type-nav\">\r\n        <div class=\"container\">\r\n            <!-- 事件的委托|事件的委派 -->\r\n            <div @mouseleave=\"leaveIndex\">\r\n                <h2 class=\"all\">全部商品分类</h2>\r\n                <!-- 三级联动 -->\r\n                <div class=\"sort\">\r\n                    <!-- 利用事件委派+编程式导航实现路由的跳转与传递参数 -->\r\n                    <div class=\"all-sort-list2\" @click=\"goSearch\">\r\n                        <div class=\"item\" v-for=\"(c1, index) in categoryList\" :key=\"c1.categoryId\"\r\n                            :class=\"{ cur: currentIndex == index }\">\r\n                            <h3 @mouseenter=\"changeIndex(index)\">\r\n                                <a :data-categoryName=\"c1.categoryName\" :data-category1Id=\"c1.categoryId\">{{\r\n                                        c1.categoryName\r\n                                }}</a>\r\n                            </h3>\r\n                            <!-- 二级、三级分类 -->\r\n                            <div class=\"item-list clearfix\"\r\n                                :style=\"{ display: currentIndex == index ? 'block' : 'none' }\">\r\n                                <div class=\"subitem\" v-for=\"(c2, index) in c1.categoryChild\" :key=\"c2.categoryId\">\r\n                                    <dl class=\"fore\">\r\n                                        <dt>\r\n                                            <a :data-categoryName=\"c2.categoryName\" :data-category2Id=\"c2.categoryId\">{{\r\n                                                    c2.categoryName\r\n                                            }}</a>\r\n                                        </dt>\r\n                                        <dd>\r\n                                            <em v-for=\"(c3, index) in c2.categoryChild\" :key=\"c3.categoryId\">\r\n                                                <a :data-categoryName=\"c3.categoryName\"\r\n                                                    :data-category3Id=\"c3.categoryId\">{{ c3.categoryName }}</a>\r\n                                            </em>\r\n                                        </dd>\r\n                                    </dl>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <nav class=\"nav\">\r\n                <a href=\"###\">服装城</a>\r\n                <a href=\"###\">美妆馆</a>\r\n                <a href=\"###\">尚品汇超市</a>\r\n                <a href=\"###\">全球购</a>\r\n                <a href=\"###\">闪购</a>\r\n                <a href=\"###\">团购</a>\r\n                <a href=\"###\">有趣</a>\r\n                <a href=\"###\">秒杀</a>\r\n            </nav>\r\n\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex';\r\n// 这种引入是把lodash的全部功能函数引入了\r\n// 按需引入\r\nimport throttle from 'lodash/throttle'\r\nexport default {\r\n    name: 'TypeNav',\r\n    data() {\r\n        return {\r\n            // 存储用户鼠标移上哪一个一级分类\r\n            currentIndex: -1\r\n        }\r\n    },\r\n    // 组件挂载完毕：可以向服务器发送请求\r\n    mounted() {\r\n        // 通知Vuex发送请求，获取数据，用于存储仓库当中\r\n        this.$store.dispatch('categoryList')\r\n    },\r\n    computed: {\r\n        ...mapState({\r\n            categoryList: (state) => {\r\n                return state.home.categoryList\r\n            }\r\n        })\r\n    },\r\n    methods: {\r\n        // 鼠标进入修改响应式数据currentIndex属性\r\n        // changeIndex(index) {\r\n        // index:鼠标移上某一个一级分类的元素的索引值\r\n        // 正常情况（用户慢慢的操作）：鼠标进入，每一个一级分类h3，都会触发鼠标进入事件\r\n        // 非正常情况（用户操作很快）：本身全部的一级分类应该触发鼠标进入事件，但是经过测试，只有一部分h3触发了\r\n        // 就是由于用户行为过快，导致浏览器反应不过来，如果当前回调函数中有一些大量的业务，有可能出现卡顿现象\r\n        // this.currentIndex = index\r\n        // },\r\n        // throttle别用箭头函数，会出现this指向的问题\r\n        changeIndex: throttle(function (index) {\r\n            this.currentIndex = index\r\n        }, 50),\r\n        // 一级分类鼠标移出的事件回调\r\n        leaveIndex() {\r\n            this.currentIndex = -1\r\n        },\r\n        goSearch() {\r\n            // 最好的解决方案：编程式导航+事件委派\r\n            //第一个问题:div父节点子元素太多【h3、h2、em、dt、dd、dl...a】？你怎么知道你点击的一定是a\r\n            //第二个问题:要区分一级分类、二级分类、三级分类的a标签 【category1Id|category2Id|category2Id】\r\n\r\n            // 第一个问题：把子节点当中a标签，我加上自定义属性data-categoryName,其余子节点是没有的\r\n            let element = event.target;\r\n            //获取到当前出发这个事件的节点【h3,a,dt,dl】,需要带有data-categoryName这样的节点【一定是a标签】\r\n            // 节点有一个属性dataset属性，可以获取节点的自定义属性与属性值\r\n            let { categoryname, category1id, category2id, category3id } =\r\n                targetNode.dataset;\r\n            // 如果标签身上拥有categoryname一定是a标签\r\n            if (categoryname) {\r\n                // 整理路由跳转的参数\r\n                let location = { name: 'search' };\r\n                let query = { categoryName: categoryname }\r\n                // 一级，二级，三级分类的a标签\r\n                if (category1id) {\r\n                    query.category1Id = category1id\r\n                } else if (category2id) {\r\n                    query.category2Id = category2id\r\n                } else {\r\n                    query.category3Id = category3id\r\n                }\r\n                // 整理参数\r\n                location.query = query\r\n                // 路由跳转\r\n                this.$router.push(location)\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.type-nav {\r\n    border-bottom: 2px solid #e1251b;\r\n\r\n    .container {\r\n        width: 1200px;\r\n        margin: 0 auto;\r\n        display: flex;\r\n        position: relative;\r\n\r\n        .all {\r\n            width: 210px;\r\n            height: 45px;\r\n            background-color: #e1251b;\r\n            line-height: 45px;\r\n            text-align: center;\r\n            color: #fff;\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n        }\r\n\r\n        .nav {\r\n            a {\r\n                height: 45px;\r\n                margin: 0 22px;\r\n                line-height: 45px;\r\n                font-size: 16px;\r\n                color: #333;\r\n            }\r\n        }\r\n\r\n        .sort {\r\n            position: absolute;\r\n            left: 0;\r\n            top: 45px;\r\n            width: 210px;\r\n            height: 461px;\r\n            position: absolute;\r\n            background: #fafafa;\r\n            z-index: 999;\r\n\r\n            .all-sort-list2 {\r\n\r\n                // height: 450px;\r\n                // overflow: hidden;\r\n                .item {\r\n                    h3 {\r\n                        line-height: 27px;\r\n                        font-size: 14px;\r\n                        font-weight: 400;\r\n                        overflow: hidden;\r\n                        padding: 0 20px;\r\n                        margin: 0;\r\n\r\n                        a {\r\n                            color: #333;\r\n                        }\r\n                    }\r\n\r\n                    .item-list {\r\n                        display: none;\r\n                        position: absolute;\r\n                        width: 734px;\r\n                        min-height: 460px;\r\n                        background: #f7f7f7;\r\n                        left: 210px;\r\n                        border: 1px solid #ddd;\r\n                        top: 0;\r\n                        z-index: 9999 !important;\r\n\r\n                        .subitem {\r\n                            float: left;\r\n                            width: 650px;\r\n                            padding: 0 4px 0 8px;\r\n\r\n                            dl {\r\n                                border-top: 1px solid #eee;\r\n                                padding: 6px 0;\r\n                                overflow: hidden;\r\n                                zoom: 1;\r\n\r\n                                &.fore {\r\n                                    border-top: 0;\r\n                                }\r\n\r\n                                dt {\r\n                                    float: left;\r\n                                    width: 54px;\r\n                                    line-height: 22px;\r\n                                    text-align: right;\r\n                                    padding: 3px 6px 0 0;\r\n                                    font-weight: 700;\r\n                                }\r\n\r\n                                dd {\r\n                                    float: left;\r\n                                    width: 415px;\r\n                                    padding: 3px 0 0;\r\n                                    overflow: hidden;\r\n\r\n                                    em {\r\n                                        float: left;\r\n                                        height: 14px;\r\n                                        line-height: 14px;\r\n                                        padding: 0 8px;\r\n                                        margin-top: 5px;\r\n                                        border-left: 1px solid #ccc;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // &:hover {\r\n                    //     .item-list {\r\n                    //         display: block;\r\n                    //     }\r\n                    // }\r\n                }\r\n\r\n                .cur {\r\n                    background: #f0c9cf;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>>"]},"metadata":{},"sourceType":"module"}